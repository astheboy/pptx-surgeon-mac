# 프로젝트의 탄생: 기획 의도와 기술적 접근 방식

이 문서는 `PPTX Surgeon` 애플리케이션이 어떤 문제 의식에서 출발했으며, 그 문제를 어떤 기술적 방식으로 해결하는지 설명합니다.

---

## 1. 문제 의식: "왜 내 슬라이드는 다른 컴퓨터에서 깨져 보일까?"

이 프로젝트의 개발은 매우 흔하지만 고질적인 문제에서 시작되었습니다.

> "분명 내 컴퓨터에서는 완벽하게 디자인된 파워포인트 슬라이드였는데, 다른 사람의 컴퓨터(특히 Mac ↔ Windows)에서 열면 폰트가 제멋대로 바뀌고 레이아웃이 전부 망가지는 걸까? 중요한 발표 직전에 이런 일이 생기면 정말 난감하다. 매번 수동으로 폰트를 찾아 바꾸는 것은 너무나 비효율적이다."

이것은 파워포인트 파일을 다루는 누구나 한 번쯤 겪어봤을 문제입니다. **발표 환경의 예측 불가능성**과 그로 인한 **결과물의 비일관성**이 바로 이 앱을 만들게 된 핵심적인 '문제 의식'입니다.


## 2. 해결하고자 하는 구체적인 문제

위와 같은 문제 의식을 바탕으로, 이 앱이 해결하고자 하는 구체적인 기술적 문제는 다음 세 가지입니다.

1.  **플랫폼 간 폰트 불일치 (Cross-Platform Font Inconsistency):**
    *   **문제:** Mac의 'AppleGothic' 폰트는 Windows에 없고, Windows의 '맑은 고딕' 폰트는 Mac에 없습니다. 이 때문에 파일을 다른 OS에서 열면, 파워포인트가 의도치 않은 폰트(예: 굴림)로 대체하여 디자인이 망가집니다.
    *   **해결 목표:** 특정 폰트를 사용자가 원하는 다른 폰트로 **일괄 교체(Mapping)**하여, 어떤 환경에서 열어도 의도한 디자인을 유지하도록 합니다.

2.  **깨진/불필요한 폰트 임베딩 (Broken/Unnecessary Font Embedding):**
    *   **문제:** 폰트를 파일에 포함(임베딩)하는 기능은 종종 불안정하게 작동하여, 파일을 열 때 오류를 일으키거나 파일 용량만 불필요하게 증가시키는 원인이 됩니다.
    *   **해결 목표:** 파일 내에 포함된 모든 **폰트 임베딩 정보를 깨끗하게 제거**하여 파일의 안정성을 높이고 용량을 최적화합니다.

3.  **복잡한 폰트 참조 정리 (Font Reference Cleanup):**
    *   **문제:** 여러 사람이 작업했거나 웹 템플릿을 사용한 파일은, 눈에 보이지 않는 수많은 폰트 참조 정보를 담고 있어 파일을 무겁게 만들고 잠재적 오류의 원인이 됩니다.
    *   **해결 목표:** 사용자가 지정한 **필수 폰트 몇 개만 남기고, 나머지 모든 폰트 참조 정보를 하나의 기본 폰트로 통합**하여 파일을 가볍고 깨끗하게 만듭니다.


## 3. 기술적인 해결 방식: "PPTX 파일의 구조를 직접 수술한다"

이 앱은 파워포인트 프로그램을 직접 제어하는 자동화 방식이 아닙니다. 대신 훨씬 더 근본적이고 강력한 방법을 사용합니다. 바로 **PPTX 파일의 내부 구조를 직접 분석하고 조작**하는 것입니다. 이 과정은 다음과 같이 진행됩니다.

1.  **압축 해제 (Unzip):** `.pptx` 파일은 사실 여러 XML 파일과 미디어 파일들을 담고 있는 **ZIP 압축 파일**입니다. 앱은 먼저 이 파일을 메모리상에서 압축 해제하여 내부 파일들에 접근합니다. (`jszip` 라이브러리 사용)

2.  **XML 분석 (XML Parsing):** 압축 해제된 폴더 안의 수많은 XML 파일들에는 슬라이드 디자인, 테마, 글자 내용, 사용된 폰트 정보 등이 정의되어 있습니다. 앱은 이 XML 파일들을 모두 읽어 "어떤 폰트가, 어디에, 어떻게 사용되었는지"에 대한 **참조 정보(Font Reference)를 모두 추출**합니다. (`slimdom`, `fontoxpath` 라이브러리 사용)

3.  **직접 수정 (Direct XML Manipulation):** 앱은 분석된 폰트 정보를 바탕으로, 사용자가 선택한 옵션(폰트 매핑, 임베딩 제거 등)에 따라 **XML 파일의 내용을 직접 수정**합니다.
    *   *예시: 'Arial'을 '나눔고딕'으로 바꾸라는 명령이 있다면, XML 파일 내의 모든 `typeface="Arial"` 이라는 텍스트를 `typeface="나눔고딕"`으로 교체합니다.*

4.  **재압축 (Re-zip):** 수정된 모든 내부 파일들을 다시 **ZIP 포맷으로 압축**하고, 확장자를 `.pptx`로 바꾸어 새로운 결과 파일을 생성합니다.

> 이 과정이 마치 외과 의사가 환자를 직접 열어 문제가 되는 부분을 정밀하게 도려내고 봉합하는 것과 같다고 하여, 프로젝트의 이름이 **"PPTX Surgeon(파워포인트 외과의사)"**이 되었습니다. 이 방식은 매우 빠르고 정확하며, 파워포인트 프로그램 자체의 버그나 한계로부터 자유롭다는 큰 장점이 있습니다.
